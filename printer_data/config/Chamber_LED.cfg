[neopixel chamber_lights]
pin: PF12
chain_count: 125
color_order: GRB
initial_RED: 0.75
initial_GREEN: 0.3
initial_BLUE: 0.3



#===========================================
# PRINTING MACRO - Reddish white 50% brightness + Progress bar setup
#===========================================
[gcode_macro LIGHTS_PRINTING]
gcode:
    # Sides: Reddish white at 50% brightness
    {% for i in range(1, 43) %}
        SET_LED LED=chamber_lights RED=0.25 GREEN=0.175 BLUE=0.125 INDEX={i} TRANSMIT=1
    {% endfor %}
    {% for i in range(85, 126) %}
        SET_LED LED=chamber_lights RED=0.25 GREEN=0.175 BLUE=0.125 INDEX={i} TRANSMIT=1
    {% endfor %}
    # Center: White background for progress bar
    {% for i in range(43, 85) %}
        SET_LED LED=chamber_lights RED=0.15 GREEN=0.15 BLUE=0.15 INDEX={i} TRANSMIT=1
    {% endfor %}
    SET_LED LED=chamber_lights TRANSMIT=1
    M117 Chamber Lights: PRINTING

#===========================================
# PRINT PROGRESS MACRO - Updates center strip with progress (LEFT TO RIGHT)
#===========================================
[gcode_macro LIGHTS_PRINT_PROGRESS]
gcode:
    {% set progress = params.PROGRESS|default(0)|float %}
    {% set progress_leds = (progress / 100 * 42)|int %}

    {% for i in range(1, 43) %}
        SET_LED LED=chamber_lights RED=0.25 GREEN=0.175 BLUE=0.125 INDEX={i} TRANSMIT=1
    {% endfor %}
    {% for i in range(85, 126) %}
        SET_LED LED=chamber_lights RED=0.25 GREEN=0.175 BLUE=0.125 INDEX={i} TRANSMIT=1
    {% endfor %}
    
    # Center strip background (dim white)
    {% for i in range(43, 85) %}
        SET_LED LED=chamber_lights RED=0.15 GREEN=0.15 BLUE=0.15 INDEX={i} TRANSMIT=1
    {% endfor %}
    
    # Progress bar (blue) from LEFT to RIGHT (43 up to 84)
    {% for i in range(43, 43 + progress_leds) %}
        SET_LED LED=chamber_lights RED=0.0 GREEN=0.15 BLUE=0.5 INDEX={i} TRANSMIT=1
    {% endfor %}
    SET_LED LED=chamber_lights TRANSMIT=1